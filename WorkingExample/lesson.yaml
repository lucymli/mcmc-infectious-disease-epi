- Class: meta
  Course: mcmc-infectious-disease-epi
  Lesson: WorkingExample
  Author: Lucy M. Li
  Type: Standard
  Organization: Harvard T.H. Chan School of Public Health
  Version: 2.4.3



- Class: cmd_question
  Output: >
    Let's have a look at the Metropolis-Hastings MCMC algorithm. 
    Type open_mcmc_file() into the command line
  CorrectAnswer: open_mcmc_file()
  AnswerTests: omnitest(correctExpr='open_mcmc_file()')
  Hint: Copy and paste the expression in the question

- Class: exact_question
  Output: >
    Identify the line of code used to propose new values of beta. 
    Enter the number in the command line.
  CorrectAnswer: 18
  AnswerTests: omnitest(correctVal=18)
  Hint: Look for lines containing the draws from the normal distribution using function rnorm()

- Class: script
  Output: >
   Let's try completing the likelihood function. I just opened an R script containing 
   the partially completed likelihood function. Follow the instructions in the script 
   comments.
   When you are ready to submit, save the script and then type submit().
   If you want to start over, type reset().
  AnswerTests: test_likelihood()
  Hint: Follow the directions in the script. You might need the dpois() and sum() functions.
  Script: likelihood.R

- Class: script
  Output: >
   Besides the likelihood, we also need to calculate the prior density of the parameters.
   I just opened an R script containing the function named flu_priors() that calculates 
   the prior probability of parameters. The overall prior probability is equal to 
   log(prior probability of beta) + log(prior probability of gamma). Complete the
   'return()' line so that the function returns the overall prior probability.
   When you are ready to submit, save the script and then type submit().
   If you want to start over, type reset().
  AnswerTests: test_prior()
  Hint: Follow the directions in the script. You might need the dpois() and sum() functions.
  Script: prior.R

- Class: figure
  Output: >
    To estimate the parameters, we can run mcmc_output <- MHmcmc(flu_data, initial_states, likelihood_function, prior_function, mcmc_options, initial_parameters). 
    You have already seen the likelihood_function and prior_function in previous questions. Let's have a look at the data, which is from a 
    1978 outbreak of influenza in a boarding school in England.
  Figure: flu_data_draw.R
  FigureType: new
  